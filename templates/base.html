<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Stycly{% endblock %}</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='stycly-favicon.png') }}">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    {% block extra_head %}{% endblock %}
</head>
<body>

 <!-- SVG ICONS -->
 <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol xmlns="http://www.w3.org/2000/svg" id="shopping-carriage" viewBox="0 0 24 24" fill="none">
      <path
        d="M5 22H19C20.103 22 21 21.103 21 20V9C21 8.73478 20.8946 8.48043 20.7071 8.29289C20.5196 8.10536 20.2652 8 20 8H17V7C17 4.243 14.757 2 12 2C9.243 2 7 4.243 7 7V8H4C3.73478 8 3.48043 8.10536 3.29289 8.29289C3.10536 8.48043 3 8.73478 3 9V20C3 21.103 3.897 22 5 22ZM9 7C9 5.346 10.346 4 12 4C13.654 4 15 5.346 15 7V8H9V7ZM5 10H7V12H9V10H15V12H17V10H19L19.002 20H5V10Z"
        fill="black" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="quick-view" viewBox="0 0 24 24">
      <path fill="currentColor"
        d="M10 18a7.952 7.952 0 0 0 4.897-1.688l4.396 4.396l1.414-1.414l-4.396-4.396A7.952 7.952 0 0 0 18 10c0-4.411-3.589-8-8-8s-8 3.589-8 8s3.589 8 8 8zm0-14c3.309 0 6 2.691 6 6s-2.691 6-6 6s-6-2.691-6-6s2.691-6 6-6z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="shopping-cart" viewBox="0 0 24 24" fill="none">
      <path
        d="M21 4H2V6H4.3L7.582 15.025C7.79362 15.6029 8.1773 16.1021 8.68134 16.4552C9.18539 16.8083 9.78556 16.9985 10.401 17H19V15H10.401C9.982 15 9.604 14.735 9.461 14.342L8.973 13H18.246C19.136 13 19.926 12.402 20.169 11.549L21.962 5.275C22.0039 5.12615 22.0109 4.96962 21.9823 4.81763C21.9537 4.66565 21.8904 4.52234 21.7973 4.39889C21.7041 4.27544 21.5837 4.1752 21.4454 4.106C21.3071 4.0368 21.1546 4.00053 21 4ZM18.246 11H8.246L6.428 6H19.675L18.246 11Z"
        fill="black" />
      <path
        d="M10.5 21C11.3284 21 12 20.3284 12 19.5C12 18.6716 11.3284 18 10.5 18C9.67157 18 9 18.6716 9 19.5C9 20.3284 9.67157 21 10.5 21Z"
        fill="black" />
      <path
        d="M16.5 21C17.3284 21 18 20.3284 18 19.5C18 18.6716 17.3284 18 16.5 18C15.6716 18 15 18.6716 15 19.5C15 20.3284 15.6716 21 16.5 21Z"
        fill="black" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="nav-icon" viewBox="0 0 16 16">
      <path
        d="M14 10.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 .5-.5zm0-3a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0 0 1h7a.5.5 0 0 0 .5-.5zm0-3a.5.5 0 0 0-.5-.5h-11a.5.5 0 0 0 0 1h11a.5.5 0 0 0 .5-.5z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="close" viewBox="0 0 16 16">
      <path
        d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="navbar-icon" viewBox="0 0 16 16">
      <path
        d="M14 10.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 .5-.5zm0-3a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0 0 1h7a.5.5 0 0 0 .5-.5zm0-3a.5.5 0 0 0-.5-.5h-11a.5.5 0 0 0 0 1h11a.5.5 0 0 0 .5-.5z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="plus" viewBox="0 0 24 24">
      <path fill="currentColor" d="M19 12.998h-6v6h-2v-6H5v-2h6v-6h2v6h6z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="minus" viewBox="0 0 24 24">
      <path fill="currentColor" d="M19 12.998H5v-2h14z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="dropdown" viewBox="0 0 24 24">
      <path fill="currentColor" d="m7 10l5 5l5-5H7Z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="user" viewBox="0 0 24 24">
      <path fill="currentColor"
        d="M12 2a5 5 0 1 0 5 5a5 5 0 0 0-5-5zm0 8a3 3 0 1 1 3-3a3 3 0 0 1-3 3zm9 11v-1a7 7 0 0 0-7-7h-4a7 7 0 0 0-7 7v1h2v-1a5 5 0 0 1 5-5h4a5 5 0 0 1 5 5v1z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="arrow-right" viewBox="0 0 24 24">
      <path fill="currentColor"
        d="M13.3 17.275q-.3-.3-.288-.725t.313-.725L16.15 13H5q-.425 0-.713-.288T4 12q0-.425.288-.713T5 11h11.15L13.3 8.15q-.3-.3-.3-.713t.3-.712q.3-.3.713-.3t.712.3L19.3 11.3q.15.15.213.325t.062.375q0 .2-.063.375t-.212.325l-4.6 4.6q-.275.275-.687.275t-.713-.3Z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="facebook" viewBox="0 0 24 24">
      <path fill="currentColor"
        d="M9.198 21.5h4v-8.01h3.604l.396-3.98h-4V7.5a1 1 0 0 1 1-1h3v-4h-3a5 5 0 0 0-5 5v2.01h-2l-.396 3.98h2.396v8.01Z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="twitter" viewBox="0 0 512 512">
      <path fill="currentColor" d="M496 109.5a201.8 201.8 0 0 1-56.55 15.3a97.51 97.51 0 0 0 43.33-53.6a197.74 197.74 0 0 1-62.56 23.5A99.14 99.14 0 0 0 348.31 64c-54.42 0-98.46 43.4-98.46 96.9a93.21 93.21 0 0 0 2.54 22.1a280.7 280.7 0 0 1-203-101.3A95.69 95.69 0 0 0 36 130.4c0 33.6 17.53 63.3 44 80.7A97.5 97.5 0 0 1 35.22 199v1.2c0 47 34 86.1 79 95a100.76 100.76 0 0 1-25.94 3.4a94.38 94.38 0 0 1-18.51-1.8c12.51 38.5 48.92 66.5 92.05 67.3A199.59 199.59 0 0 1 39.5 405.6a203 203 0 0 1-23.5-1.4A278.68 278.68 0 0 0 166.74 448c181.36 0 280.44-147.7 280.44-275.8c0-4.2-.11-8.4-.31-12.5A198.48 198.48 0 0 0 496 109.5Z"/>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="youtube" viewBox="0 0 32 32">
      <path fill="currentColor"
        d="M29.41 9.26a3.5 3.5 0 0 0-2.47-2.47C24.76 6.2 16 6.2 16 6.2s-8.76 0-10.94.59a3.5 3.5 0 0 0-2.47 2.47A36.13 36.13 0 0 0 2 16a36.13 36.13 0 0 0 .59 6.74a3.5 3.5 0 0 0 2.47 2.47c2.18.59 10.94.59 10.94.59s8.76 0 10.94-.59a3.5 3.5 0 0 0 2.47-2.47A36.13 36.13 0 0 0 30 16a36.13 36.13 0 0 0-.59-6.74ZM13.2 20.2v-8.4l7.27 4.2Z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="instagram" viewBox="0 0 256 256">
      <path fill="currentColor"
        d="M128 80a48 48 0 1 0 48 48a48.05 48.05 0 0 0-48-48Zm0 80a32 32 0 1 1 32-32a32 32 0 0 1-32 32Zm48-136H80a56.06 56.06 0 0 0-56 56v96a56.06 56.06 0 0 0 56 56h96a56.06 56.06 0 0 0 56-56V80a56.06 56.06 0 0 0-56-56Zm40 152a40 40 0 0 1-40 40H80a40 40 0 0 1-40-40V80a40 40 0 0 1 40-40h96a40 40 0 0 1 40 40ZM192 76a12 12 0 1 1-12-12a12 12 0 0 1 12 12Z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="pinterest" viewBox="0 0 24 24">
      <path fill="currentColor"
        d="M9.04 21.54c.96.29 1.93.46 2.96.46a10 10 0 0 0 10-10A10 10 0 0 0 12 2A10 10 0 0 0 2 12c0 4.25 2.67 7.9 6.44 9.34c-.09-.78-.18-2.07 0-2.96l1.15-4.94s-.29-.58-.29-1.5c0-1.38.86-2.41 1.84-2.41c.86 0 1.26.63 1.26 1.44c0 .86-.57 2.09-.86 3.27c-.17.98.52 1.84 1.52 1.84c1.78 0 3.16-1.9 3.16-4.58c0-2.4-1.72-4.04-4.19-4.04c-2.82 0-4.48 2.1-4.48 4.31c0 .86.28 1.73.74 2.3c.09.06.09.14.06.29l-.29 1.09c0 .17-.11.23-.28.11c-1.28-.56-2.02-2.38-2.02-3.85c0-3.16 2.24-6.03 6.56-6.03c3.44 0 6.12 2.47 6.12 5.75c0 3.44-2.13 6.2-5.18 6.2c-.97 0-1.92-.52-2.26-1.13l-.67 2.37c-.23.86-.86 2.01-1.29 2.7v-.03Z" />
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" id="search" viewBox="0 0 24 24">
      <path fill="currentColor"
        d="M10 18a7.952 7.952 0 0 0 4.897-1.688l4.396 4.396l1.414-1.414l-4.396-4.396A7.952 7.952 0 0 0 18 10c0-4.411-3.589-8-8-8s-8 3.589-8 8s3.589 8 8 8zm0-14c3.309 0 6 2.691 6 6s-2.691 6-6 6s-6-2.691-6-6s2.691-6 6-6z" />
    </symbol>
  </svg>

<header class="stycly-header">
    <div class="stycly-logo">
        <a href="{{ url_for('home') }}">
            <img src="{{ url_for('static', filename='stycly-logo.png') }}" alt="Stycly logo">
        </a>
    </div>

    <!-- HAMBURGER -->
    <button class="stycly-nav-hamburger" id="navToggle" aria-label="Apri menu">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <!-- MENU DESKTOP / MOBILE -->
    <nav class="stycly-nav" id="mainNav">
        <a href="{{ url_for('home') }}"
           class="{% if request.endpoint == 'home' %}nav-active{% endif %}">
            HOME
        </a>

        <a href="{{ url_for('products') }}"
           class="{% if request.endpoint in ['products'] %}nav-active{% endif %}">
            PRODUCTS
        </a>

        <a href="{{ url_for('about') }}"
           class="{% if request.endpoint == 'about' %}nav-active{% endif %}">
            ABOUT US
        </a>

        <a href="{{ url_for('contact') }}"
           class="{% if request.endpoint == 'contact' %}nav-active{% endif %}">
            CONTACT
        </a>

        {% if session.get('user_id') %}
            <a href="{{ url_for('private_wardrobe') }}"
               class="{% if request.endpoint == 'private_wardrobe' %}nav-active{% endif %}">
                PRIVATE WARDROBE
            </a>

            <!-- MENU UTENTE A TENDINA (INVARIATO) -->
            <div class="user-menu">
                <button type="button" class="user-menu-toggle">
                    {{ current_user_username or session.get('username') }}
                    <span class="user-menu-arrow">â–¾</span>
                </button>

                <div class="user-menu-dropdown">
                    <div class="user-menu-info">
                        <div class="user-menu-name">
                            {{ current_user_username or session.get('username') }}
                        </div>
                        <div class="user-menu-email">
                            {{ current_user_email or session.get('email') }}
                        </div>
                        {% if current_user_last_added %}
                            <div class="user-menu-last">
                                Ultimo capo inserito:<br>
                                <strong>{{ current_user_last_added }}</strong>
                            </div>
                        {% else %}
                            <div class="user-menu-last">
                                Nessun capo inserito finora.
                            </div>
                        {% endif %}
                    </div>

                    <div class="user-menu-actions">
                        <!-- SVUOTA WARDROBE -->
                        <form method="POST"
                              action="{{ url_for('clear_wardrobe') }}"
                              onsubmit="return confirm('Vuoi svuotare completamente il tuo wardrobe?');">
                            <button type="submit"
                                    class="user-menu-btn user-menu-btn-clear">
                                Svuota wardrobe
                            </button>
                        </form>

                        <!-- ELIMINA ACCOUNT -->
                        <form method="POST"
                              action="{{ url_for('delete_account') }}"
                              onsubmit="return confirm('Vuoi eliminare definitivamente il tuo account e tutti i dati associati? L&#39;operazione Ã¨ irreversibile.');">
                            <button type="submit"
                                    class="user-menu-btn user-menu-btn-delete">
                                Elimina account
                            </button>
                        </form>

                        <!-- LOGOUT -->
                        <a href="{{ url_for('logout') }}"
                           class="user-menu-link-logout">
                            Logout
                        </a>
                    </div>
                </div>
            </div>
        {% else %}
            <!-- PRIMA C'ERA IL TESTO "AREA RISERVATA" -->
            <!-- ORA SOLO ICONA OMINO, MA STESSO ID PER IL JS DEL MODAL -->
            <button type="button"
                    id="area-riservata-link"
                    class="header-icon-btn"
                    aria-label="Area riservata">
                <svg class="icon-24">
                    <use xlink:href="#user"></use>
                </svg>
            </button>
        {% endif %}

        <!-- ðŸ”” NUOVE ICONE: CARRELLO + SEARCH, SEMPRE VISIBILI -->
        <div class="header-icons-group">
            <!-- CARRELLO -->
            <button type="button"
                    id="open-cart"
                    class="header-icon-btn"
                    aria-label="Apri carrello">
                <svg class="icon-24">
                    <use xlink:href="#shopping-cart"></use>
                </svg>
            </button>

            <!-- SEARCH -->
            <button type="button"
                    id="open-search"
                    class="header-icon-btn"
                    aria-label="Cerca">
                <svg class="icon-24">
                    <use xlink:href="#search"></use>
                </svg>
            </button>
        </div>
    </nav>
</header>

<main>
   {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-container">
          {% for category, message in messages %}
            <div class="flash flash-{{ category }}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
</main>

<!-- MODAL LOGIN / REGISTER (INVARIATO) -->
<div id="authModal" class="auth-modal">
  <div class="auth-card">
    <!-- Pulsante chiusura -->
    <button id="authClose" class="auth-close-btn" type="button">&times;</button>

    <div class="auth-container">
      <!-- TABS -->
      <div class="auth-tabs">
        <button
          type="button"
          class="auth-tab active"
          data-target="loginPanel">
          Accedi
        </button>
        <button
          type="button"
          class="auth-tab"
          data-target="registerPanel">
          Registrati
        </button>
      </div>

      <!-- CONTENUTO PANNELLI -->
      <div class="auth-panels">
        <!-- PANNELLO LOGIN -->
        <div id="loginPanel" class="auth-panel active">
          <h2>Accedi</h2>

          <form method="POST"
                action="{{ url_for('login') }}"
                class="auth-form"
                autocomplete="off">

            <div class="auth-field-wrap">
              <label for="login_email_or_username">
                Email o username<span class="req">*</span>
              </label>
              <input
                id="login_email_or_username"
                type="text"
                name="email_or_username"
                required
                autocomplete="off">
            </div>

            <div class="auth-field-wrap">
              <label for="login_password">
                Password<span class="req">*</span>
              </label>
              <input
                id="login_password"
                type="password"
                name="password"
                required
                autocomplete="off">
            </div>

            <p class="forgot">
              <a href="{{ url_for('forgot_password') }}">
                Hai dimenticato la password?
              </a>
            </p>

            <button type="submit" class="button button-block">
              Accedi
            </button>
          </form>
        </div>

        <!-- PANNELLO REGISTRAZIONE -->
        <div id="registerPanel" class="auth-panel">
          <h2>Crea il tuo account</h2>

          <form method="POST"
                action="{{ url_for('register') }}"
                class="auth-form"
                autocomplete="off">

            <div class="auth-field-wrap">
              <label for="reg_username">
                Username<span class="req">*</span>
              </label>
              <input
                id="reg_username"
                type="text"
                name="username"
                required
                autocomplete="off">
            </div>

            <div class="auth-field-wrap">
              <label for="reg_email">
                Email<span class="req">*</span>
              </label>
              <input
                id="reg_email"
                type="email"
                name="email"
                required
                autocomplete="off">
            </div>

            <div class="auth-field-wrap">
              <label for="reg_password">
                Password<span class="req">*</span>
              </label>
              <input
                id="reg_password"
                type="password"
                name="password"
                required
                autocomplete="off">
            </div>

            <div class="auth-field-wrap">
              <label for="reg_confirm_password">
                Conferma password<span class="req">*</span>
              </label>
              <input
                id="reg_confirm_password"
                type="password"
                name="confirm_password"
                required
                autocomplete="off">
            </div>

            <p class="password-hint">
              La password deve avere almeno 8 caratteri e contenere
              almeno una lettera e un numero.
            </p>

            <button type="submit" class="button button-block">
              Registrati
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ðŸ”” NUOVO: POPUP CARRELLO -->
<div id="cart-overlay" class="cart-overlay cart-hidden">
  <div class="cart-modal">
    <div class="cart-header">
      <h2>Cart</h2>
      <button type="button" class="cart-close" id="close-cart" aria-label="Chiudi carrello">
        <svg class="icon-20">
          <use xlink:href="#close"></use>
        </svg>
      </button>
    </div>

    <div class="cart-body">
      <!-- Lista articoli -->
      <div class="cart-items"></div>

      <!-- Messaggio carrello vuoto -->
      <div class="cart-empty">
        Il carrello Ã¨ vuoto.
      </div>

      <!-- Totale pezzi -->
      <div class="cart-summary">
        <span>Totale capi:</span>
        <span id="cart-total-items">0</span>
      </div>

      <div class="cart-actions">
        <button type="button" class="cart-btn primary">View Cart</button>
        <button type="button" class="cart-btn">Checkout</button>
      </div>
    </div>
  </div>
</div>

<!-- ðŸ” NUOVO: POPUP SEARCH (semplice, poi lo colleghiamo ai prodotti) -->
<div id="search-overlay" class="search-overlay cart-hidden">
  <div class="search-modal">
    <div class="search-header">
      <h2>Cerca</h2>
      <button type="button" class="cart-close" id="close-search" aria-label="Chiudi ricerca">
        <svg class="icon-20">
          <use xlink:href="#close"></use>
        </svg>
      </button>
    </div>
    <input type="text" class="search-input" placeholder="Cerca un capo... (da implementare)" />
  </div>
</div>

{% block extra_js %}{% endblock %}
<!-- ðŸ”” JS CARRELLO -->
<script src="{{ url_for('static', filename='cart.js') }}"></script>
<script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>













