{% extends "base.html" %}
{% block title %}My Wardrobe - Stycly{% endblock %}

{% block content %}
<section class="stycly-hero">
  <div class="wardrobe-view-layout">
    <div class="wardrobe-main">
      <h2>{{ username }} Personal Wardrobe</h2>
      <p style="margin-top: 0.5rem; font-size: 0.95rem; color: #555;">
        Aggiungi, modifica o elimina i capi del tuo guardaroba personale.
      </p>

      <div class="wardrobe-grid wardrobe-grid-3col">
        {% for capo in capi %}
        <div class="capo-card">
          <div class="capo-img-wrapper">
            {% if capo['immagine'] %}
              <img
                src="{{ url_for('immagini', filename=(capo['immagine'] or '').split('/')[-1]) }}"
                alt="Capo"
                class="capo-img">
            {% else %}
              <p style="font-size:0.8rem; color:#777; text-align:center;">
                Nessuna immagine
              </p>
            {% endif %}
          </div>

          <div class="capo-info">
            <div><strong>{{ capo.get('categoria') or '' }}</strong></div>
            <div>{{ capo.get('tipologia') or '' }}</div>
            <div>
              {% if capo.get('taglia') %}Taglia: {{ capo['taglia'] }}{% endif %}
              {% if capo.get('colore') %}<br>Colore: {{ capo['colore'] }}{% endif %}
            </div>
            {% if capo.get('brand') %}
              <div>Brand: {{ capo['brand'] }}</div>
            {% endif %}
            {% if capo.get('destinazione') %}
              <div>Destinazione: {{ capo['destinazione'] }}</div>
            {% endif %}
            {% if capo.get('fit') %}
              <div>Fit: {{ capo['fit'] }}</div>
            {% endif %}
          </div>

          <div class="capo-actions">
            <a
              href="{{ url_for('modifica_capo_wardrobe', nome_tabella=nome_tabella, capo_id=capo['id']) }}"
              class="capo-icon-btn"
              title="Modifica capo">
              <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
                <path d="M14.7 2.29a1 1 0 0 1 1.42 0l1.59 1.59a1 1 0 0 1 0 1.42l-9.3 9.3-2.12.71.71-2.12 9.3-9.3zM3 17h14v2H3v-2z" fill="#1468e5"/>
              </svg>
            </a>

            <form
              method="POST"
              action="{{ url_for('elimina_capo_wardrobe', nome_tabella=nome_tabella, capo_id=capo['id']) }}"
              style="margin:0;">
              <button
                type="submit"
                class="capo-icon-btn"
                title="Elimina capo"
                onclick="return confirm('Vuoi eliminare questo capo?');">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                     viewBox="0 0 24 24" fill="none">
                  <path d="M3 6h18M10 11v6M14 11v6M5 6l1 14a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2l1-14M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"
                        stroke="#cc3d3d" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </button>
            </form>
          </div>
        </div>
        {% endfor %}

        <!-- Card per aggiungere nuovo capo -->
        <div class="capo-card empty-card">
          <a
            href="{{ url_for('aggiungi_capo_wardrobe', nome_tabella=nome_tabella) }}"
            class="capo-icon-btn"
            title="Aggiungi nuovo capo">
            <svg width="32" height="32" viewBox="0 0 22 22" fill="none">
              <circle cx="11" cy="11" r="10" fill="#7b9acc"/>
              <path d="M11 7v8M7 11h8" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}
